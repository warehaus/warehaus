mixin page_header
  .page-header
    .page-header-row
      .page-header-row-cell.x3
        i.icon-chemistry
      .page-header-row-cell
        .x12
          a(ui-sref='^.^')
            lab-name(id='lab_id')
          i.fa.fa-fw.fa-angle-right
          a(ui-sref='^')
            object-type-title(type-id='type_obj_id')
          i.fa.fa-fw.fa-angle-right
          strong
            object-name(id='obj_id')
      .page-header-row-cell.text-right
        span
    ul.page-header-nav
      li.padding

mixin server_info_resources
  .panel.panel-default(ng-if='dbObjects.byId[obj_id].hw_info')
    .panel-heading
      | Resources
    table.table.text-center
      tr
        td(style={width: '33%'})
          h1
            | {{ dbObjects.byId[obj_id].hw_info.cpu[0]['cpu MHz'] / 1024 | number:2 }}
            | &#32;
            | GHz
          | CPU
        td(style={width: '33%'})
          h1
            | {{ dbObjects.byId[obj_id].hw_info.mem.MemTotal | numeraljs:'capacity' }}
          | RAM
        td(style={width: '33%'})
          h1
            | {{ dbObjects.byId[obj_id].hw_info.fs['/'].total_bytes | numeraljs:'capacity' }}
          | Filesystem

mixin server_info_net
  .panel.panel-default(ng-if='dbObjects.byId[obj_id].hw_info.net')
    .panel-heading
      | Network
    table.table.hw-info-table
      tr(ng-repeat='net in dbObjects.byId[obj_id].hw_info.net | orderBy: "dev"')
        td.hw-info-icon
          i.icon-share
        td.hw-info-content
          span.label.label-primary
            | {{ net.dev }}
          | &#32;
          | {{ net.mac }}
          div(ng-repeat='ipv4 in net.inet', style={color: '#bbb'})
            | {{ ipv4 }}
          div(ng-repeat='ipv6 in net.inet6' style={color: '#bbb'})
            | {{ ipv6 }}
        td.hw-info-switches
          .x2.text-success
            i.fa.fa-toggle-on

mixin server_info_block_devices
  .panel.panel-default(ng-if='dbObjects.byId[obj_id].hw_info.block_devices')
    .panel-heading
      | Block Devices
    table.table.hw-info-table
      tr(ng-repeat='blockdev in dbObjects.byId[obj_id].hw_info.block_devices')
        td.hw-info-icon
          i.fa.fa-database(ng-if='blockdev.type == "disk"')
          i.icon-disc(ng-if='blockdev.type == "rom"')
        td.hw-info-content
          span.label.label-primary
            | /dev/{{ blockdev.name }}
          br
          span(style={color: '#bbb'})
            | {{ blockdev.model }} ({{ blockdev.size | numeraljs:'capacity' }})

mixin server_info_pci_devices
  .panel.panel-default(ng-if='dbObjects.byId[obj_id].hw_info.pci_devices')
    .panel-heading
      | PCI Devices
    table.table.hw-info-table
      tr(ng-repeat='pcidev in dbObjects.byId[obj_id].hw_info.pci_devices')
        td.hw-info-icon
          i.fa.fa-sitemap
        td.hw-info-content
          span.label.label-primary
            | {{ pcidev.address }}
          | &#32;
          | {{ pcidev.name }}
          br
          span(style={color: '#bbb'})
            | {{ pcidev.type }}, {{ pcidev.vendor }}

mixin server_info
  +server_info_resources
  +server_info_net
  +server_info_block_devices
  +server_info_pci_devices

mixin navigation
  ul
    li.heading
      | Status
    li
      span
        .status-dot.status-dot-3x(class='status-dot-{{ dbObjects.byId[obj_id].status }}')
        | &#32;
        | Online
        br
        span.opacity05
          | Last seen {{ moment(dbObjects.byId[obj_id].last_heartbeat).fromNow() }}
    li.heading
      | Cluster
    li(ng-if='clustersToServers.cluster_of_server[obj_id]')
      span
        i.fa.fa-server
        object-name(id='clustersToServers.cluster_of_server[obj_id]')
        br
        a.link(ng-click='remove_from_cluster()')
          i.fa.fa-minus-circle
          | &#32;
          | Remove From Cluster
    li(ng-if='!clustersToServers.cluster_of_server[obj_id]')
      a.link(ng-click='add_to_cluster()')
        i.fa.fa-plus-circle
        | &#32;
        | Add To Cluster

mixin content
  .page-layout
    .page-layout-nav
      +navigation
    .page-layout-content
      +server_info

div(ng-controller='ServerPageController')
  +page_header
  +content
